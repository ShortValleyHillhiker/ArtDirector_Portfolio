(()=>{var r={observers:{intersection:null,video:null,load:null},handlers:{navToggle:null,navLinks:new Map,options:new Map,helpToggle:null,introScroll:null},abortControllers:new Set,createDebouncedScrollHandler(){let e;return function(){clearTimeout(e),e=setTimeout(()=>{let{scrollLeft:t,scrollWidth:i,clientWidth:n}=this;document.querySelector(".scroll-mask.left")?.classList.toggle("scrolled",t>16),document.querySelector(".scroll-mask.right")?.classList.toggle("scrolled",t<i-n)},16)}},delayedInit(e,t=25){setTimeout(()=>{try{e()}catch(i){console.error("Initialization error:",i)}},t)},addEventListenerWithCleanup(e,t,i,n={}){let o=new AbortController;return this.abortControllers.add(o),e.addEventListener(t,i,{...n,signal:o.signal}),o},initializeNavToggle(){let e=document.getElementById("nav-toggle"),t=document.getElementById("main-nav");if(!e||!t)return;this.handlers.navToggle=()=>{t.classList.toggle("open")},this.addEventListenerWithCleanup(e,"click",this.handlers.navToggle),document.querySelectorAll("#main-nav a").forEach(n=>{let o=()=>{window.innerWidth<=540&&t.classList.remove("open")};this.addEventListenerWithCleanup(n,"click",o),this.handlers.navLinks.set(n,o)})},initializeOptions(){let e=document.querySelector("#intro");e&&e.querySelectorAll(".option").forEach(t=>{let i=()=>{e.querySelectorAll(".active").forEach(o=>o.classList.remove("active")),t.classList.add("active");let n=t.classList[1];e.querySelector(`.message.${n}`)?.classList.add("active")};this.addEventListenerWithCleanup(t,"click",i),this.handlers.options.set(t,i)})},initializeIntroScroll(){let e=document.querySelector(".intro-options");e&&(this.handlers.introScroll=this.createDebouncedScrollHandler(),this.addEventListenerWithCleanup(e,"scroll",this.handlers.introScroll))},initializeIntersectionObserver(){let e=document.querySelectorAll("section[id]"),t=document.querySelectorAll('#main-nav a[href^="#"]');if(this.observers.intersection&&this.observers.intersection.disconnect(),!(e.length===0||t.length===0))try{this.observers.intersection=new IntersectionObserver(i=>{i.forEach(n=>{if(n.isIntersecting){let o=document.querySelector(`#main-nav a[href="#${n.target.id}"]`);o&&(document.querySelectorAll("#main-nav li").forEach(s=>s.classList.remove("active")),o.parentElement.classList.add("active"))}})},{threshold:.1,rootMargin:"-10% 0px"}),e.forEach(i=>this.observers.intersection.observe(i))}catch(i){console.error("Failed to create intersection observer:",i)}},initializeLoadAnimations(){let e=document.querySelectorAll(".on-load");if(e.length===0)return;let t=70;try{this.observers.load=new IntersectionObserver(i=>{i.sort((n,o)=>n.target.compareDocumentPosition(o.target)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1),i.forEach((n,o)=>{n.isIntersecting&&(setTimeout(()=>{n.target.classList.add("loaded-in")},o*t),this.observers.load.unobserve(n.target))})},{threshold:.1,rootMargin:"-5% 0px"}),e.forEach(i=>{this.observers.load.observe(i)})}catch(i){console.error("Failed to create load animation observer:",i)}},initializeHelpToggle(){let e=document.getElementById("case-more-toggle"),t=document.querySelector(".case-more");if(!e||!t)return;let i=e.querySelector("span");i&&(this.handlers.helpToggle=()=>{let n=t.classList.toggle("triggered");i.textContent=n?"F\xF6rminska bakgrund":"Expandera bakgrund"},this.addEventListenerWithCleanup(e,"click",this.handlers.helpToggle))},initializeVideoObserver(){let e=document.querySelectorAll("video");if(e.length!==0){this.observers.video&&(this.observers.video.disconnect(),this.observers.video=null);try{this.observers.video=new IntersectionObserver(t=>{t.forEach(i=>{let n=i.target;i.isIntersecting?n.paused&&n.play().catch(()=>{console.log("Video autoplay failed for:",n.src)}):n.paused||n.pause()})},{threshold:0,rootMargin:"0% 0px"}),e.forEach(t=>{this.observers.video.observe(t)})}catch(t){console.error("Failed to create video observer:",t)}}},initializePageElements(){this.initializeNavToggle(),this.initializeOptions(),this.initializeIntroScroll(),this.initializeIntersectionObserver(),this.initializeHelpToggle()},initializeDelayedElements(){this.initializeLoadAnimations(),this.initializeVideoObserver()},cleanup(){Object.values(this.observers).forEach(e=>{e&&e.disconnect()}),this.observers={intersection:null,video:null,load:null},this.abortControllers.forEach(e=>{e.abort()}),this.abortControllers.clear(),this.handlers={navToggle:null,navLinks:new Map,options:new Map,helpToggle:null,introScroll:null}}};document.addEventListener("DOMContentLoaded",()=>{let e=new Swup({plugins:[new SwupHeadPlugin]});r.initializePageElements(),initializeTester(),r.delayedInit(()=>{r.initializeDelayedElements()}),e.hooks.on("page:view",()=>{r.initializePageElements(),initializeTester()}),e.hooks.on("animation:in:end",()=>{r.delayedInit(()=>{r.initializeDelayedElements()})}),window.addEventListener("popstate",()=>{r.delayedInit(()=>{r.initializeDelayedElements()})}),e.hooks.on("animation:out:start",()=>{r.cleanup()})});})();
