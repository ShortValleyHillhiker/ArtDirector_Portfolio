(()=>{var b={spacing:16,baseRadius:4,rippleWidth:24,rippleSpeed:14,dragCooldown:50,maxRipples:25,fadeFactor:.9,frameRate:12};function O(e,t,d=b.baseRadius){let i=[],s=e.width-2*d,p=e.height-2*d,n=Math.floor(s/t),h=Math.floor(p/t),r=n*t,a=h*t,c=(e.width-r)/2,w=(e.height-a)/2;for(let u=0;u<=h;u++)for(let g=0;g<=n;g++)i.push({x:c+g*t,y:w+u*t});return i}function L(e,t,d){let i="#eee",s=e.canvas,p=document.querySelector("main");s.classList.contains("theme-aware")&&p?.classList.contains("inverted")&&(i="#1c1c1c"),s.classList.contains("theme-dark")&&(i="#eee"),e.fillStyle=i;for(let n=0;n<t.length;n++){let{x:h,y:r}=t[n],a=d(t[n]);a<=0||(e.beginPath(),e.arc(Math.round(h),Math.round(r),a,0,Math.PI*2),e.fill())}}function C(e,t,d=b.baseRadius){let i=e.parentElement;return e.width=i.clientWidth,e.height=i.clientHeight,O(e,t,d)}function S(e,t,d,i){let s=Math.floor(t),n=(Math.floor(d)*i+s)*4,[h,r,a]=e.data.slice(n,n+3);return(.299*h+.587*r+.114*a)/255}var{spacing:v,baseRadius:W}=b,T=1e3/12,B=10;function N(e){let t=e.getContext("2d"),i=e.parentElement.querySelector("img");if(!i)return;let s=document.createElement("canvas"),p=s.getContext("2d",{willReadFrequently:!0}),n=[],h=null,r=0,a=!1,c=!1,w=0,u=()=>{t.clearRect(0,0,e.width,e.height),L(t,n,({x:l,y:m})=>{let y=1+(1-S(h,l,m,e.width)-1)*r;return Math.round(W*y*2)})},g=()=>{p.drawImage(i,0,0,e.width,e.height),h=p.getImageData(0,0,e.width,e.height)},x=()=>{n=C(e,v),s.width=e.width,s.height=e.height,i.complete&&i.naturalWidth&&g()},o=l=>{if(l-w>=T&&(w=l,r=Math.min(r+1/B,1),u(),r>=1)){a=!1,c=!0;return}a&&requestAnimationFrame(o)},f=()=>{a||c||(a=!0,r=0,requestAnimationFrame(o))};i.onload=()=>{x(),u()},i.complete&&i.naturalWidth&&(x(),u()),window.addEventListener("resize",()=>{x(),u()}),new IntersectionObserver(([l])=>{l.isIntersecting&&!c&&setTimeout(f,350)},{threshold:.1}).observe(e)}function I(){document.querySelectorAll("canvas.ripple-canvas.halftone").forEach(N)}var{spacing:G,baseRadius:k,rippleWidth:M,rippleSpeed:X,dragCooldown:Y,maxRipples:P,fadeFactor:_,frameRate:V}=b,$=1e3/V;function j(e){let t=e.getContext("2d"),d=e.classList.contains("touch"),i=e.classList.contains("automatic"),s=e.classList.contains("loop"),p=C(e,G),n=[],h=0,r=!1,a=0,c=!1,w=!0,u=()=>{t.clearRect(0,0,e.width,e.height),L(t,p,({x:o,y:f})=>{let l=1;for(let m of n){if(m.alpha<.01)continue;let A=o-m.x,y=f-m.y;if(Math.abs(A)>m.radius+M||Math.abs(y)>m.radius+M)continue;let q=A*A+y*y,E=m.radius-M,F=m.radius+M;if(q<E*E||q>F*F)continue;let H=Math.sqrt(q),z=Math.abs(H-m.radius);l+=(1-z/M)*m.alpha*2}return Math.round(k*l)})},g=o=>{o-h>=$&&(h=o,u(),n=n.map(l=>({...l,radius:l.radius+X,alpha:l.alpha*_})).filter(l=>l.alpha>.01),i&&Math.random()<.1&&x(Math.random()*e.width,Math.random()*e.height),s&&n.length===0&&x(e.width/2,e.height/2)),w&&(n.length||i||s||d&&r)?requestAnimationFrame(g):c=!1},x=(o,f)=>{w&&(n.length>=P&&n.shift(),n.push({x:o,y:f,radius:0,alpha:1}),c||(c=!0,requestAnimationFrame(g)))};d&&(e.addEventListener("pointerdown",o=>{r=!0;let f=e.getBoundingClientRect();x(o.clientX-f.left,o.clientY-f.top),a=Date.now()}),e.addEventListener("pointerup",()=>r=!1),e.addEventListener("pointermove",o=>{if(!r||Date.now()-a<Y)return;let f=e.getBoundingClientRect();x(o.clientX-f.left,o.clientY-f.top),a=Date.now()})),window.addEventListener("resize",()=>{clearTimeout(e._resizeTimeout),e._resizeTimeout=setTimeout(()=>{p=C(e,G),u()},250)}),new IntersectionObserver(([o])=>{w=o.isIntersecting,w&&!c&&(c=!0,requestAnimationFrame(g))},{threshold:.1}).observe(e),u(),c||(c=!0,requestAnimationFrame(g))}function R(){document.querySelectorAll("canvas.ripple-canvas:not(.halftone)").forEach(j)}var J=new Swup;function D(){document.querySelectorAll(".expander-toggle").forEach(e=>{let t=document.getElementById(e.dataset.target);t&&e.addEventListener("click",()=>{t.classList.toggle("hidden")})})}document.addEventListener("DOMContentLoaded",()=>{document.querySelector("canvas.halftone")&&I(),R(),D();let e=document.querySelector(".page-bottom"),t=document.querySelector("header");if(e&&t){let d=t.offsetHeight;new IntersectionObserver(([s])=>{s.isIntersecting?document.body.classList.add("nav-inverted"):document.body.classList.remove("nav-inverted")},{root:null,threshold:0,rootMargin:`0px 0px -${window.innerHeight-d*.95}px 0px`}).observe(e)}});J.hooks.on("page:view",({visit:e})=>{document.querySelector("canvas.halftone")&&I(),R(),D()});})();
